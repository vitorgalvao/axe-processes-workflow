<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>bundleid</key>
	<string>com.vitorgalvao.alfred.axeprocesses</string>
	<key>connections</key>
	<dict>
		<key>043BB5FF-386A-4307-BD82-0C1E2152D9AA</key>
		<array>
			<dict>
				<key>destinationuid</key>
				<string>4B708B3A-FAAD-42CC-91ED-7BC9294013B5</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
		</array>
		<key>39BB5E45-0070-432B-AF0D-70B326813CD8</key>
		<array>
			<dict>
				<key>destinationuid</key>
				<string>54EE2F26-10E8-4445-A23E-F42E5CA09F38</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
			<dict>
				<key>destinationuid</key>
				<string>0D672FFC-6AE8-44A2-B589-5F98A9792942</string>
				<key>modifiers</key>
				<integer>1048576</integer>
				<key>modifiersubtext</key>
				<string>Force kill</string>
				<key>vitoclose</key>
				<false/>
			</dict>
			<dict>
				<key>destinationuid</key>
				<string>7C9A8236-785A-4582-901B-F478DE741E5F</string>
				<key>modifiers</key>
				<integer>524288</integer>
				<key>modifiersubtext</key>
				<string>Switch sort order</string>
				<key>vitoclose</key>
				<true/>
			</dict>
		</array>
		<key>7C9A8236-785A-4582-901B-F478DE741E5F</key>
		<array>
			<dict>
				<key>destinationuid</key>
				<string>043BB5FF-386A-4307-BD82-0C1E2152D9AA</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>sourceoutputuid</key>
				<string>28C9F1B9-BDE0-4437-999A-20C106E9D21D</string>
				<key>vitoclose</key>
				<false/>
			</dict>
			<dict>
				<key>destinationuid</key>
				<string>ECC273C2-A449-437C-A013-202951981174</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>sourceoutputuid</key>
				<string>598ACA6B-C34F-4A14-9EA2-CE48ED766FF6</string>
				<key>vitoclose</key>
				<false/>
			</dict>
		</array>
		<key>ECC273C2-A449-437C-A013-202951981174</key>
		<array>
			<dict>
				<key>destinationuid</key>
				<string>4B708B3A-FAAD-42CC-91ED-7BC9294013B5</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
		</array>
	</dict>
	<key>createdby</key>
	<string>Vítor Galvão</string>
	<key>description</key>
	<string>Monitor and terminate processes</string>
	<key>disabled</key>
	<false/>
	<key>name</key>
	<string>Axe Processes</string>
	<key>objects</key>
	<array>
		<dict>
			<key>config</key>
			<dict>
				<key>alfredfiltersresults</key>
				<false/>
				<key>alfredfiltersresultsmatchmode</key>
				<integer>0</integer>
				<key>argumenttreatemptyqueryasnil</key>
				<true/>
				<key>argumenttrimmode</key>
				<integer>0</integer>
				<key>argumenttype</key>
				<integer>1</integer>
				<key>escaping</key>
				<integer>102</integer>
				<key>keyword</key>
				<string>{var:axe_keyword}</string>
				<key>queuedelaycustom</key>
				<integer>3</integer>
				<key>queuedelayimmediatelyinitially</key>
				<true/>
				<key>queuedelaymode</key>
				<integer>0</integer>
				<key>queuemode</key>
				<integer>1</integer>
				<key>runningsubtext</key>
				<string>Gathering running processes…</string>
				<key>script</key>
				<string>function envVar(varName) {
  return $.NSProcessInfo
    .processInfo
    .environment
    .objectForKey(varName).js
}

function runCommand(...arguments) {
  const task = $.NSTask.alloc.init
  const stdout = $.NSPipe.pipe

  task.executableURL = $.NSURL.fileURLWithPath("/usr/bin/env")
  task.arguments = arguments
  task.standardOutput = stdout
  task.launchAndReturnError(false)

  const dataOut = stdout.fileHandleForReading.readDataToEndOfFileAndReturnError(false)
  const stringOut = $.NSString.alloc.initWithDataEncoding(dataOut, $.NSUTF8StringEncoding).js

  return stringOut
}
console.log(["ps", `-${envVar("sort_by_flag")}`, "-cAo", "%cpu=,%mem=,pid=,command="].join(" "))
const processes = runCommand("ps", `-${envVar("sort_by_flag")}`, "-cAo", "%cpu=,%mem=,pid=,command=")
  .split("\n")
  .slice(0, -1)
  .map(item =&gt; {
    const fields = item.split(" ").filter(field =&gt; field)

    return {
      cpu: fields[0],
      memory: fields[1],
      pid: fields[2],
      command: fields.slice(3).join(" ")
    }
  })

function run(argv) {
  const sfItems = processes.flatMap(process =&gt; {
    if (argv[0] &amp;&amp; !new RegExp(argv[0], "i").test(process.command)) return []

    return {
      uid: process.pid,
      title: process.command,
      subtitle: `CPU: ${process.cpu}% · Memory: ${process.memory}% · PID: ${process.pid}`,
      arg: process.pid
    }
  })

  return JSON.stringify({
    rerun: 1,
    skipknowledge: true,
    items: sfItems
  })
}</string>
				<key>scriptargtype</key>
				<integer>1</integer>
				<key>scriptfile</key>
				<string></string>
				<key>skipuniversalaction</key>
				<true/>
				<key>subtext</key>
				<string>{const:alfred_workflow_description}</string>
				<key>title</key>
				<string>{const:alfred_workflow_name}</string>
				<key>type</key>
				<integer>7</integer>
				<key>withspace</key>
				<true/>
			</dict>
			<key>inboundconfig</key>
			<dict>
				<key>externalid</key>
				<string>view_processes</string>
			</dict>
			<key>type</key>
			<string>alfred.workflow.input.scriptfilter</string>
			<key>uid</key>
			<string>39BB5E45-0070-432B-AF0D-70B326813CD8</string>
			<key>version</key>
			<integer>3</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>concurrently</key>
				<false/>
				<key>escaping</key>
				<integer>102</integer>
				<key>script</key>
				<string>/bin/kill -15 "${1}"</string>
				<key>scriptargtype</key>
				<integer>1</integer>
				<key>scriptfile</key>
				<string></string>
				<key>type</key>
				<integer>11</integer>
			</dict>
			<key>type</key>
			<string>alfred.workflow.action.script</string>
			<key>uid</key>
			<string>54EE2F26-10E8-4445-A23E-F42E5CA09F38</string>
			<key>version</key>
			<integer>2</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>concurrently</key>
				<false/>
				<key>escaping</key>
				<integer>102</integer>
				<key>script</key>
				<string>/bin/kill -9 "${1}"</string>
				<key>scriptargtype</key>
				<integer>1</integer>
				<key>scriptfile</key>
				<string></string>
				<key>type</key>
				<integer>11</integer>
			</dict>
			<key>type</key>
			<string>alfred.workflow.action.script</string>
			<key>uid</key>
			<string>0D672FFC-6AE8-44A2-B589-5F98A9792942</string>
			<key>version</key>
			<integer>2</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>externaltriggerid</key>
				<string>view_processes</string>
				<key>passinputasargument</key>
				<false/>
				<key>passvariables</key>
				<true/>
				<key>workflowbundleid</key>
				<string>self</string>
			</dict>
			<key>type</key>
			<string>alfred.workflow.output.callexternaltrigger</string>
			<key>uid</key>
			<string>4B708B3A-FAAD-42CC-91ED-7BC9294013B5</string>
			<key>version</key>
			<integer>1</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>argument</key>
				<string></string>
				<key>passthroughargument</key>
				<false/>
				<key>variables</key>
				<dict>
					<key>sort_by_flag</key>
					<string>m</string>
				</dict>
			</dict>
			<key>type</key>
			<string>alfred.workflow.utility.argument</string>
			<key>uid</key>
			<string>043BB5FF-386A-4307-BD82-0C1E2152D9AA</string>
			<key>version</key>
			<integer>1</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>conditions</key>
				<array>
					<dict>
						<key>inputstring</key>
						<string>{var:sort_by_flag}</string>
						<key>matchcasesensitive</key>
						<false/>
						<key>matchmode</key>
						<integer>0</integer>
						<key>matchstring</key>
						<string>r</string>
						<key>outputlabel</key>
						<string>Memory</string>
						<key>uid</key>
						<string>28C9F1B9-BDE0-4437-999A-20C106E9D21D</string>
					</dict>
					<dict>
						<key>inputstring</key>
						<string>{var:sort_by_flag}</string>
						<key>matchcasesensitive</key>
						<false/>
						<key>matchmode</key>
						<integer>0</integer>
						<key>matchstring</key>
						<string>m</string>
						<key>outputlabel</key>
						<string>CPU</string>
						<key>uid</key>
						<string>598ACA6B-C34F-4A14-9EA2-CE48ED766FF6</string>
					</dict>
				</array>
				<key>elselabel</key>
				<string></string>
				<key>hideelse</key>
				<true/>
			</dict>
			<key>type</key>
			<string>alfred.workflow.utility.conditional</string>
			<key>uid</key>
			<string>7C9A8236-785A-4582-901B-F478DE741E5F</string>
			<key>version</key>
			<integer>1</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>argument</key>
				<string></string>
				<key>passthroughargument</key>
				<false/>
				<key>variables</key>
				<dict>
					<key>sort_by_flag</key>
					<string>r</string>
				</dict>
			</dict>
			<key>type</key>
			<string>alfred.workflow.utility.argument</string>
			<key>uid</key>
			<string>ECC273C2-A449-437C-A013-202951981174</string>
			<key>version</key>
			<integer>1</integer>
		</dict>
	</array>
	<key>readme</key>
	<string>## Usage

Search active processes, live sorted by CPU or memory usage, via the `axe` keyword.

![Listing processes](images/about/axe.png)

* &lt;kbd&gt;↩&lt;/kbd&gt; Ask process to terminate with TERM (software termination signal).
* &lt;kbd&gt;⌘&lt;/kbd&gt;&lt;kbd&gt;↩&lt;/kbd&gt; Force process to terminate with KILL (non-catchable, non-ignorable kill).
* &lt;kbd&gt;⌥&lt;/kbd&gt;&lt;kbd&gt;↩&lt;/kbd&gt; Flip sorting between CPU and memory usage.</string>
	<key>uidata</key>
	<dict>
		<key>043BB5FF-386A-4307-BD82-0C1E2152D9AA</key>
		<dict>
			<key>xpos</key>
			<real>370</real>
			<key>ypos</key>
			<real>355</real>
		</dict>
		<key>0D672FFC-6AE8-44A2-B589-5F98A9792942</key>
		<dict>
			<key>xpos</key>
			<real>450</real>
			<key>ypos</key>
			<real>210</real>
		</dict>
		<key>39BB5E45-0070-432B-AF0D-70B326813CD8</key>
		<dict>
			<key>xpos</key>
			<real>80</real>
			<key>ypos</key>
			<real>65</real>
		</dict>
		<key>4B708B3A-FAAD-42CC-91ED-7BC9294013B5</key>
		<dict>
			<key>xpos</key>
			<real>450</real>
			<key>ypos</key>
			<real>355</real>
		</dict>
		<key>54EE2F26-10E8-4445-A23E-F42E5CA09F38</key>
		<dict>
			<key>xpos</key>
			<real>450</real>
			<key>ypos</key>
			<real>65</real>
		</dict>
		<key>7C9A8236-785A-4582-901B-F478DE741E5F</key>
		<dict>
			<key>xpos</key>
			<real>255</real>
			<key>ypos</key>
			<real>375</real>
		</dict>
		<key>ECC273C2-A449-437C-A013-202951981174</key>
		<dict>
			<key>xpos</key>
			<real>365</real>
			<key>ypos</key>
			<real>415</real>
		</dict>
	</dict>
	<key>userconfigurationconfig</key>
	<array>
		<dict>
			<key>config</key>
			<dict>
				<key>default</key>
				<string>axe</string>
				<key>placeholder</key>
				<string></string>
				<key>required</key>
				<false/>
				<key>trim</key>
				<true/>
			</dict>
			<key>description</key>
			<string></string>
			<key>label</key>
			<string>Axe Keyword</string>
			<key>type</key>
			<string>textfield</string>
			<key>variable</key>
			<string>axe_keyword</string>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>default</key>
				<string>r</string>
				<key>pairs</key>
				<array>
					<array>
						<string>CPU</string>
						<string>r</string>
					</array>
					<array>
						<string>Memory</string>
						<string>m</string>
					</array>
				</array>
			</dict>
			<key>description</key>
			<string></string>
			<key>label</key>
			<string>Sort By</string>
			<key>type</key>
			<string>popupbutton</string>
			<key>variable</key>
			<string>sort_by_flag</string>
		</dict>
	</array>
	<key>variables</key>
	<dict>
		<key>default_cpu_limit</key>
		<string>30</string>
		<key>default_renice</key>
		<string>1</string>
		<key>rerun_timer</key>
		<string>3</string>
	</dict>
	<key>version</key>
	<string>2025.1</string>
	<key>webaddress</key>
	<string>https://github.com/vitorgalvao/axe-processes-workflow/</string>
</dict>
</plist>
